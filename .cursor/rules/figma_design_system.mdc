# Figma Design System Rules for OneView

This document provides comprehensive guidance for integrating Figma designs into the OneView codebase using the Figma MCP (Model Context Protocol).

## 1. Design Token Definitions

### Token Location
All design tokens are defined in `app/globals.css` using the Tailwind CSS v4 `@theme` directive. **There is NO `tailwind.config.js`** - all customization happens in CSS.

```css
/* File: app/globals.css */
@import "tailwindcss";
@plugin "daisyui" {
  themes: light --default;
}

@theme {
  /* Tokens defined here */
}
```

### Color Tokens

#### Brand Colors
```css
--color-oneview-dark: #2a3847;      /* Primary dark navy */
--color-oneview-purple: #6e56cf;     /* Primary accent purple */
--color-primary: #2a3847;
--color-primary-content: #ffffff;
--color-accent: #6e56cf;
--color-accent-content: #ffffff;
```

**Figma Mapping:**
- When extracting designs, map Figma's primary color to `#2a3847`
- Map accent/highlight colors to `#6e56cf`
- Always use `bg-accent`, `text-accent`, `border-accent` classes for purple

#### Surface & Background Colors
```css
/* Card & Surface Colors (with transparency for layering) */
--color-card: #ffffff;
--color-card-muted: rgb(255 255 255 / 0.6);
--color-border: rgb(229 231 235);
--color-border-subtle: rgb(229 231 235 / 0.8);
--color-ring: rgb(110 86 207 / 0.3);

/* Background hierarchy */
--color-background: #ffffff;
--color-background-muted: #f9fafb;
--color-background-subtle: #f3f4f6;
```

**Figma Mapping:**
- Primary backgrounds → `bg-background`
- Subtle backgrounds → `bg-background-muted` or `bg-background-subtle`
- Card backgrounds → Use `card-modern` or `card-solid` utility classes

### Typography Tokens

#### Font Family
```css
--font-display: "Satoshi", "sans-serif";
```

**Implementation:**
- Font loaded via `next/font/google` in `app/layout.tsx`
- Uses `Overpass` family (not Satoshi in practice)
- Font class applied globally on `<html>` element

```typescript
// app/layout.tsx
import { Overpass } from "next/font/google";
const font = Overpass({ subsets: ["latin"] });
```

#### Text Sizes (Figma → Tailwind)
| Figma Size | Tailwind Class | CSS Value |
|-----------|---------------|-----------|
| 48-56px   | `text-5xl` or `text-6xl` | Hero headings |
| 36-40px   | `text-4xl` | Section headings |
| 24-32px   | `text-2xl` or `text-3xl` | Subsection headings |
| 18-20px   | `text-lg` or `text-xl` | Body large |
| 14-16px   | `text-sm` or `text-base` | Body text |
| 12px      | `text-xs` | Small text, labels |

#### Font Weights
| Weight | Tailwind Class | Usage |
|--------|---------------|--------|
| 800-900 | `font-extrabold` | Hero headings |
| 700 | `font-bold` | Section headings |
| 600 | `font-semibold` | Subheadings, emphasis |
| 500 | `font-medium` | Navigation, buttons |
| 400 | (default) | Body text |

### Spacing Tokens

#### Standard Spacing Scale (Tailwind Default)
- `space-1` → `0.25rem` (4px)
- `space-2` → `0.5rem` (8px)
- `space-3` → `0.75rem` (12px)
- `space-4` → `1rem` (16px)
- `space-6` → `1.5rem` (24px)
- `space-8` → `2rem` (32px)
- `space-12` → `3rem` (48px)
- `space-16` → `4rem` (64px)

#### Custom Section Spacing
```css
/* Section spacing rhythm */
.section-spacing {
  @apply py-12 sm:py-20;  /* Mobile: 48px, Desktop: 80px */
}

.section-spacing-lg {
  @apply py-16 sm:py-24;  /* Mobile: 64px, Desktop: 96px */
}
```

#### Container Widths
```css
.container-primary {
  @apply max-w-6xl mx-auto px-4 sm:px-6;  /* 1152px max width */
}

.container-narrow {
  @apply max-w-3xl mx-auto px-4 sm:px-6;  /* 768px max width */
}
```

**Figma Mapping:**
- Standard sections → Use `section-spacing`
- Hero sections → Use `section-spacing-lg`
- Content width → Use `container-primary` or `container-narrow`

### Animation Tokens

```css
/* Animation tokens - aligned with Vexly timing */
--animate-shimmer: shimmer 3s ease-out infinite alternate;
--animate-opacity: opacity 0.25s ease-in-out;
--animate-appearFromRight: appearFromRight 300ms ease-in-out;
--animate-wiggle: wiggle 1.5s ease-in-out infinite;
--animate-popup: popup 0.25s ease-in-out;
--animate-scribble: scribble 1.5s ease-in-out forwards;
--animate-accordion: accordion 400ms ease-in-out;
--animate-transition: transition 400ms ease-in-out;
```

**Usage Pattern:**
```tsx
// Apply animation class
<div className="animate-shimmer">Content</div>

// Custom scribble animation (Hero component pattern)
<svg
  className={`${isScribbled ? "animate-scribble" : "opacity-0"}`}
  style={{
    transition: "stroke-dashoffset 1.5s ease-in-out",
  }}
>
```

### Border Radius Tokens

| Size | Tailwind Class | CSS Value | Usage |
|------|---------------|-----------|--------|
| Small | `rounded` | 0.25rem (4px) | Small elements |
| Medium | `rounded-lg` | 0.5rem (8px) | Cards, buttons |
| Large | `rounded-xl` | 0.75rem (12px) | Large cards |
| XL | `rounded-2xl` | 1rem (16px) | Hero elements |
| Full | `rounded-full` | 9999px | Pills, badges, avatars |

**Figma Mapping:**
- Buttons → `rounded-full` (pill shape)
- Cards → `rounded-xl`
- Icons/Badges → `rounded-full` or `rounded-2xl`

### Shadow Tokens

```css
/* Apply via Tailwind utilities */
shadow-sm    /* 0 1px 2px rgba(0,0,0,0.05) */
shadow       /* 0 1px 3px rgba(0,0,0,0.1) */
shadow-md    /* 0 4px 6px rgba(0,0,0,0.1) */
shadow-lg    /* 0 10px 15px rgba(0,0,0,0.1) */
shadow-xl    /* 0 20px 25px rgba(0,0,0,0.1) */
```

**Common Patterns:**
```tsx
// Elevated cards
<div className="shadow-lg">

// Hovered cards
<div className="shadow-lg hover:shadow-xl transition-shadow">

// Button hover
<button className="shadow-md hover:shadow-lg">
```

## 2. Component Library Architecture

### Component Organization

```
components/
├── Core UI Components
│   ├── ButtonGradient.tsx       # Gradient-styled button
│   ├── ButtonCheckout.tsx       # Stripe checkout integration
│   ├── ButtonSignin.tsx         # Authentication button
│   ├── ButtonLead.tsx           # Lead capture CTA
│   ├── ButtonAccount.tsx        # User account dropdown
│   ├── ButtonPopover.tsx        # Popover container
│   └── ButtonSupport.tsx        # Crisp chat integration
│
├── Layout Components
│   ├── Header.tsx               # Navigation header
│   ├── Footer.tsx               # Site footer
│   └── LayoutClient.tsx         # Client-side layout wrapper
│
├── Landing Page Sections
│   ├── Hero.tsx                 # Hero with animated underlines
│   ├── Problem.tsx              # Problem agitation (3-step flow)
│   ├── FeaturesAccordion.tsx    # Accordion-style features
│   ├── FeaturesGrid.tsx         # Grid-style features
│   ├── FeaturesListicle.tsx     # List-style features
│   ├── Pricing.tsx              # 4-tier pricing table
│   ├── FAQ.tsx                  # FAQ accordion
│   ├── CTA.tsx                  # Final conversion section
│   └── WithWithout.tsx          # Before/after comparison
│
├── Supporting Components
│   ├── TestimonialsAvatars.tsx  # Avatar group
│   ├── Testimonial1Small.tsx    # Compact testimonial
│   ├── TestimonialRating.tsx    # Star rating display
│   ├── Testimonials1.tsx        # Testimonial layout 1
│   ├── Testimonials11.tsx       # Testimonial layout 11
│   ├── Testimonials3.tsx        # Testimonial layout 3
│   ├── BetterIcon.tsx           # Icon wrapper with styling
│   ├── Modal.tsx                # Modal dialog
│   └── Tabs.tsx                 # Tab navigation
```

### Component Patterns

#### 1. Server Components (Default)
```tsx
// Default export for main component
// No "use client" directive
// Can use async/await for data fetching

const MyComponent = () => {
  return (
    <section className="section-spacing">
      {/* Content */}
    </section>
  );
};

export default MyComponent;
```

#### 2. Client Components (Interactive)
```tsx
"use client";

import { useState } from "react";

const InteractiveComponent = () => {
  const [state, setState] = useState(false);

  return (
    <button onClick={() => setState(!state)}>
      Toggle
    </button>
  );
};

export default InteractiveComponent;
```

**When to Use "use client":**
- Event handlers (`onClick`, `onChange`, etc.)
- React hooks (`useState`, `useEffect`, `useRef`, etc.)
- Browser APIs (`window`, `document`, `localStorage`, etc.)
- Third-party libraries that use browser APIs

#### 3. Component Props Pattern
```tsx
interface MyComponentProps {
  title?: string;
  onClick?: () => void;
  children?: React.ReactNode;
  extraStyle?: string;
}

const MyComponent = ({
  title = "Default Title",
  onClick = () => {},
  children,
  extraStyle = "",
}: MyComponentProps) => {
  return (
    <div className={`base-classes ${extraStyle}`}>
      {children}
    </div>
  );
};

export default MyComponent;
```

### Reusable Component Examples

#### Button Gradient Component
```tsx
// components/ButtonGradient.tsx
"use client";

const ButtonGradient = ({
  title = "Gradient Button",
  onClick = () => {},
}: {
  title?: string;
  onClick?: () => void;
}) => {
  return (
    <button className="btn btn-gradient animate-shimmer" onClick={onClick}>
      {title}
    </button>
  );
};
```

**CSS Class Applied:**
```css
.btn-gradient {
  background-color: #6e56cf !important;
  border: 0 !important;
  border-color: transparent !important;
  color: white !important;
  border-radius: 9999px !important;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
  transition: all 0.2s ease-in-out !important;
}

.btn-gradient:hover {
  background-color: #5d4ab0 !important;
  transform: translateY(-2px) scale(1.02) !important;
  box-shadow: 0 10px 15px -3px rgb(110 86 207 / 0.3) !important;
}
```

#### Better Icon Component
```tsx
// components/BetterIcon.tsx
const BetterIcon = ({ children }: { children: React.ReactNode }) => {
  return (
    <div className="w-12 h-12 inline-flex items-center justify-center rounded-full bg-primary/20 text-primary">
      {children}
    </div>
  );
};
```

**Usage:**
```tsx
<BetterIcon>
  <svg className="w-6 h-6">{/* SVG path */}</svg>
</BetterIcon>
```

## 3. Frameworks & Libraries

### Core Stack

#### Next.js 15 + React 19
- **Next.js Version:** 15.1.8
- **React Version:** 19.0.0
- **TypeScript:** 5.9.2

**Critical Next.js 15 Patterns:**

```typescript
// ✅ REQUIRED: Async APIs in Next.js 15
import { cookies, headers } from "next/headers";

// Always await these APIs
const cookieStore = await cookies();
const headersList = await headers();
const { id } = await params; // Dynamic route params
```

#### Supabase (Authentication & Database)
```typescript
// ✅ REQUIRED: Server-side client is async
import { createClient } from "@/libs/supabase/server";

const supabase = await createClient();
const { data: { user } } = await supabase.auth.getUser();
```

### Styling Stack

#### Tailwind CSS v4 (CSS-First Configuration)
- **Version:** 4.1.10
- **PostCSS Plugin:** @tailwindcss/postcss v4.1.10
- **Configuration:** All in `app/globals.css` using `@theme` directive

**NO `tailwind.config.js` FILE EXISTS**

```css
/* All Tailwind customization in app/globals.css */
@import "tailwindcss";

@theme {
  --color-brand: #6e56cf;
  --spacing-custom: 2.5rem;
}
```

#### DaisyUI v5
- **Version:** 5.0.5
- **Theme:** Light mode only
- **Configuration:** Plugin loaded in `globals.css`

```css
@plugin "daisyui" {
  themes: light --default;
}
```

**DaisyUI Components Used:**
- `.btn` - Base button styling
- `.btn-primary` - Primary button variant
- `.btn-ghost` - Ghost button variant
- `.card` - Card container
- `.badge` - Badge/pill element
- `.divider` - Horizontal divider

### UI Libraries

#### HeadlessUI v2
- **Version:** 2.2.0
- **Usage:** Unstyled, accessible UI components
- **Common Components:** Dialog, Popover, Disclosure

#### React Hot Toast
- **Version:** 2.4.1
- **Usage:** Toast notifications

```tsx
import toast from "react-hot-toast";

toast.success("Action completed!");
toast.error("Something went wrong");
```

#### React Tooltip
- **Version:** 5.28.0
- **Usage:** Tooltips for UI elements

### Build System

#### Build Commands
```json
{
  "dev": "next dev",           // Development server
  "build": "next build",       // Production build
  "postbuild": "next-sitemap", // Generate sitemap
  "start": "next start",       // Production server
  "lint": "next lint"          // ESLint
}
```

#### PostCSS Configuration
- Autoprefixer v10.4.20
- Tailwind CSS PostCSS plugin v4.1.10

## 4. Asset Management

### Asset Storage Structure

```
public/
├── blog/
│   └── introducing-supabase/
│       └── header.png
├── oneview_logo.svg          # Logo icon only
├── oneview_name_logo.svg     # Logo with name
├── blurry-gradient.svg       # Background gradient
├── Heading.svg               # SVG text graphic
├── MacBook Pro M4 16-inch Silver.png  # Device mockup
└── undraw_*.svg              # Illustration library
    ├── undraw_personal-finance_xpqg.svg
    ├── undraw_presentation_4ik4.svg
    ├── undraw_finance_m6vw.svg
    └── undraw_spreadsheets_bh6n.svg
```

### Asset Usage Patterns

#### Logo Implementation
```tsx
import Image from "next/image";

// With name (Header)
<Image
  src="/oneview_name_logo.svg"
  alt="OneView logo"
  className="h-32 w-auto"
  priority={true}
  width={120}
  height={28}
/>

// Icon only
<Image
  src="/oneview_logo.svg"
  alt="OneView"
  width={40}
  height={40}
/>
```

#### SVG Illustrations
```tsx
// Inline SVG (Problem component pattern)
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8 text-red-600">
  <path strokeLinecap="round" strokeLinejoin="round" d="..." />
</svg>

// Image component for external SVG
<Image
  src="/undraw_finance_m6vw.svg"
  alt="Finance illustration"
  width={400}
  height={300}
/>
```

### Asset Optimization

#### Next.js Image Optimization
- Automatic format conversion (WebP/AVIF)
- Responsive image sizing
- Lazy loading by default (except `priority={true}`)

```tsx
<Image
  src="/image.png"
  alt="Description"
  width={800}
  height={600}
  quality={90}          // Default: 75
  priority={false}      // Default: false (lazy load)
  placeholder="blur"    // Optional blur placeholder
/>
```

#### No CDN Configuration
- No AWS S3/CloudFront in use
- All assets served from `/public` directory
- Vercel CDN handles optimization in production

### Favicon Management

```
app/
├── favicon.ico          # Main favicon
├── favicon 2.ico        # Backup
└── favicon old.ico      # Legacy
```

**Figma Mapping:**
- Export favicons as 32x32px and 16x16px ICO
- Place in `app/` directory (not `public/`)
- Next.js automatically serves from root

## 5. Icon System

### Inline SVG Icons (Heroicons Pattern)

**Primary Method:** Inline SVG from Heroicons (outline/solid)

```tsx
// Checkmark icon (common in features)
<svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  className="w-5 h-5 text-accent shrink-0"
>
  <path
    fillRule="evenodd"
    d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
    clipRule="evenodd"
  />
</svg>
```

### Icon Sizing Convention

| Size Class | CSS Value | Usage |
|-----------|-----------|--------|
| `w-3 h-3` | 12px | Tiny icons in badges |
| `w-4 h-4` | 16px | Inline text icons |
| `w-5 h-5` | 20px | List item icons |
| `w-6 h-6` | 24px | Button icons |
| `w-8 h-8` | 32px | Feature card icons |
| `w-12 h-12` | 48px | Large feature icons |
| `w-16 h-16` | 64px | Hero section icons |

### Icon Color Patterns

```tsx
// Accent color (purple)
<svg className="w-6 h-6 text-accent">

// Dynamic color (inherits parent)
<svg className="w-6 h-6 text-current">

// Muted color
<svg className="w-6 h-6 text-base-content/70">

// Gradient background + colored icon
<div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-red-100 to-red-50 flex items-center justify-center ring-4 ring-red-100/50">
  <svg className="w-8 h-8 text-red-600">
</div>
```

### BetterIcon Wrapper Component

```tsx
// File: components/BetterIcon.tsx
<BetterIcon>
  <svg className="w-6 h-6">{/* icon path */}</svg>
</BetterIcon>

// Renders as:
<div className="w-12 h-12 inline-flex items-center justify-center rounded-full bg-primary/20 text-primary">
  {/* icon */}
</div>
```

**Usage in Features:**
```tsx
<div className="flex items-center gap-4">
  <BetterIcon>
    <svg className="w-6 h-6"><!-- checkmark --></svg>
  </BetterIcon>
  <span>Feature description</span>
</div>
```

### Custom SVG Animations

**Scribble Underline (Hero Component):**
```tsx
<svg
  className={`absolute -bottom-2 left-0 w-full h-3 ${
    isScribbled ? "animate-scribble" : "opacity-0"
  }`}
  viewBox="0 0 120 12"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M2 10C20 3 40 1 60 5C80 9 100 7 118 10"
    stroke="#6e56cf"
    strokeWidth="3"
    strokeLinecap="round"
    strokeDasharray="200"
    strokeDashoffset={isScribbled ? "0" : "200"}
    style={{
      transition: "stroke-dashoffset 1.5s ease-in-out",
    }}
  />
</svg>
```

## 6. Styling Approach

### CSS Methodology: Utility-First (Tailwind)

**Philosophy:**
- Compose styles using Tailwind utility classes
- Minimal custom CSS (only in `globals.css`)
- Responsive design via breakpoint prefixes
- State variants via pseudo-class modifiers

### Global CSS Structure

```css
/* File: app/globals.css */

/* 1. Import Tailwind */
@import "tailwindcss";

/* 2. Configure DaisyUI */
@plugin "daisyui" { themes: light --default; }

/* 3. Define theme tokens */
@theme { /* custom properties */ }

/* 4. Base styles */
html, body { scroll-behavior: smooth !important; }

/* 5. Custom component classes */
.btn-gradient { /* ... */ }
.card-modern { /* ... */ }
.section-spacing { /* ... */ }
```

### Custom Utility Classes

#### Card Patterns
```css
/* Modern card with transparency */
.card-modern {
  @apply rounded-xl border border-border-subtle bg-card/60 backdrop-blur-sm;
  @apply ring-1 ring-border/80;
  @apply transition-all duration-300;
}

.card-modern:hover {
  @apply bg-card shadow-lg ring-ring;
}

/* Solid card */
.card-solid {
  @apply rounded-xl border-0 bg-card;
  @apply ring-1 ring-border/80;
  @apply transition-all duration-300;
}
```

**Usage:**
```tsx
<div className="card-modern p-6">
  {/* Card content */}
</div>
```

#### Section Spacing
```css
.section-spacing {
  @apply py-12 sm:py-20;
}

.section-spacing-lg {
  @apply py-16 sm:py-24;
}
```

**Usage:**
```tsx
<section className="section-spacing">
  <div className="container-primary">
    {/* Section content */}
  </div>
</section>
```

#### Container Widths
```css
.container-primary {
  @apply max-w-6xl mx-auto px-4 sm:px-6;
}

.container-narrow {
  @apply max-w-3xl mx-auto px-4 sm:px-6;
}
```

### Responsive Design Patterns

#### Breakpoints (Tailwind Default)
```
sm:  640px  (mobile landscape, small tablets)
md:  768px  (tablets)
lg:  1024px (laptops, desktops)
xl:  1280px (large desktops)
2xl: 1536px (ultra-wide)
```

#### Responsive Text Sizing
```tsx
<h1 className="text-4xl sm:text-5xl md:text-6xl lg:text-7xl">
  Responsive Heading
</h1>
```

#### Responsive Layout
```tsx
<div className="flex flex-col lg:flex-row gap-4">
  {/* Stacked on mobile, side-by-side on desktop */}
</div>
```

#### Responsive Spacing
```tsx
<section className="py-12 sm:py-20">
  <div className="px-4 sm:px-6">
    {/* Content */}
  </div>
</section>
```

### State Variants

#### Hover States
```tsx
<button className="bg-accent hover:bg-accent/90 hover:scale-105 transition-all">
  Hover Me
</button>
```

#### Focus States
```tsx
<input className="border-border focus:border-accent focus:ring-ring focus:ring-2" />
```

#### Group Hover
```tsx
<div className="group">
  <span className="group-hover:text-accent transition-colors">
    Hover parent to change this
  </span>
</div>
```

### Color Opacity Pattern

```tsx
/* Background with opacity */
<div className="bg-accent/10">     {/* 10% opacity */}
<div className="bg-accent/20">     {/* 20% opacity */}
<div className="bg-accent/50">     {/* 50% opacity */}

/* Text with opacity */
<p className="text-base-content/70">  {/* 70% opacity */}
<p className="text-base-content/60">  {/* 60% opacity */}

/* Border with opacity */
<div className="border border-accent/30">
```

### Gradient Patterns

```tsx
// Background gradient blur effect (Hero)
<div className="absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-accent/5 blur-3xl rounded-full"></div>

// Gradient text
<span className="bg-gradient-to-r from-base-content to-base-content/80 bg-clip-text">

// Gradient icon background
<div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-red-100 to-red-50 flex items-center justify-center">
```

### Shadow & Ring Patterns

```tsx
// Card with subtle ring
<div className="ring-1 ring-border/80 shadow-lg">

// Hover state with ring
<div className="hover:ring-ring/30 transition-all">

// Featured item with accent ring
<div className="ring-2 ring-accent/20 shadow-xl">
```

### Backdrop Blur Pattern

```tsx
// Glassmorphism effect
<div className="bg-card/60 backdrop-blur-sm">

// Header with blur
<header className="bg-background/50 backdrop-blur-2xl border-b border-accent/10">
```

## 7. Project Structure

### Application Architecture

```
oneview-shipfast/
├── app/                      # Next.js 15 app directory
│   ├── api/                  # API routes
│   │   ├── stripe/           # Stripe checkout & portal
│   │   ├── auth/callback/    # Supabase OAuth callback
│   │   ├── webhook/stripe/   # Stripe webhook handler
│   │   └── lead/             # Lead capture endpoint
│   │
│   ├── dashboard/            # Protected dashboard (planned)
│   │   ├── layout.tsx
│   │   └── page.tsx
│   │
│   ├── blog/                 # MDX blog
│   │   ├── _assets/
│   │   ├── [articleId]/
│   │   ├── layout.tsx
│   │   └── page.tsx
│   │
│   ├── signin/               # Authentication pages
│   │   ├── layout.tsx
│   │   └── page.tsx
│   │
│   ├── layout.tsx            # Root layout (font, metadata)
│   ├── page.tsx              # Landing page
│   ├── globals.css           # Tailwind + custom CSS
│   ├── error.tsx             # Error boundary
│   ├── tos/                  # Terms of Service
│   └── privacy-policy/       # Privacy Policy
│
├── components/               # React components (see Section 2)
│   ├── [ComponentName].tsx
│   └── ...
│
├── libs/                     # Utility libraries
│   ├── supabase/
│   │   ├── server.ts         # Server-side Supabase client
│   │   ├── client.ts         # Client-side Supabase client
│   │   └── middleware.ts     # Session refresh middleware
│   ├── stripe.ts             # Stripe utilities
│   ├── resend.ts             # Email utilities
│   ├── seo.ts                # SEO metadata generation
│   └── api.ts                # API client (axios)
│
├── types/                    # TypeScript type definitions
│   ├── config.ts             # Config type definitions
│   └── ...
│
├── public/                   # Static assets (see Section 4)
│   ├── oneview_logo.svg
│   └── ...
│
├── config.ts                 # App configuration (pricing, branding)
├── CLAUDE.md                 # Project instructions
├── package.json              # Dependencies
├── tsconfig.json             # TypeScript config
└── next.config.mjs           # Next.js config
```

### Route Organization

#### Public Routes (No Auth)
```
/                    → Landing page (Hero, Problem, Features, Pricing, FAQ, CTA)
/signin              → Sign in page
/blog                → Blog index
/blog/[articleId]    → Blog article
/tos                 → Terms of Service
/privacy-policy      → Privacy Policy
```

#### Protected Routes (Auth Required)
```
/dashboard           → Main dashboard (planned)
/dashboard/*         → Dashboard subpages (planned)
```

#### API Routes
```
POST /api/stripe/create-checkout     → Create Stripe checkout session
POST /api/stripe/create-portal       → Create Stripe customer portal
POST /api/webhook/stripe             → Stripe webhook handler
GET  /api/auth/callback              → Supabase OAuth callback
POST /api/lead                       → Lead capture
```

### Feature Organization Pattern

**Colocation Strategy:**
- Components in `/components` directory
- Utilities in `/libs` directory
- Types in `/types` directory
- API routes in `/app/api` directory
- Page routes in `/app/[route]` directory

**Import Pattern:**
```tsx
// Next.js & React
import { useState } from "react";
import Link from "next/link";
import Image from "next/image";

// Third-party libraries
import axios from "axios";
import toast from "react-hot-toast";

// Internal components
import ButtonCheckout from "@/components/ButtonCheckout";
import Header from "@/components/Header";

// Internal utilities
import { createClient } from "@/libs/supabase/server";
import config from "@/config";

// Internal types
import type { ConfigProps } from "@/types/config";

// Relative imports
import "./styles.css";
```

## 8. Figma-to-Code Translation Rules

### Component Extraction Workflow

1. **Use Figma MCP Tools**
   ```
   mcp__figma-remote-mcp__get_design_context
   - fileKey: Extract from Figma URL
   - nodeId: Extract from node-id parameter (e.g., "1:2")
   ```

2. **Map Figma Layers to Components**
   - Frame → `<section>` or `<div>`
   - Text → `<h1>`, `<p>`, or `<span>`
   - Button → `<button>` or `<Link>`
   - Image → `<Image>` component

3. **Apply Design Tokens**
   - Extract colors → Map to `--color-*` tokens
   - Extract typography → Map to Tailwind text classes
   - Extract spacing → Map to Tailwind spacing classes

### Color Mapping Rules

| Figma Color | CSS Token | Tailwind Class |
|------------|-----------|----------------|
| Primary Navy | `#2a3847` | `bg-primary`, `text-primary` |
| Accent Purple | `#6e56cf` | `bg-accent`, `text-accent` |
| White | `#ffffff` | `bg-background`, `text-white` |
| Light Gray | `#f9fafb` | `bg-background-muted` |
| Border Gray | `rgb(229 231 235)` | `border-border` |

### Typography Mapping

```typescript
// Figma font weight → Tailwind class
900 → font-extrabold
700 → font-bold
600 → font-semibold
500 → font-medium
400 → (default)

// Figma font size → Tailwind class
48-56px → text-5xl or text-6xl
36-40px → text-4xl
24-32px → text-2xl or text-3xl
18-20px → text-lg or text-xl
14-16px → text-sm or text-base
12px → text-xs
```

### Spacing & Layout Translation

```typescript
// Figma auto-layout → Flexbox
Horizontal + Space Between → flex flex-row justify-between
Vertical + Center → flex flex-col items-center
Gap: 16px → gap-4

// Figma padding → Tailwind padding
8px → p-2
16px → p-4
24px → p-6
32px → p-8

// Figma max-width → Tailwind max-width
1152px → max-w-6xl (container-primary)
768px → max-w-3xl (container-narrow)
```

### Shadow & Effect Mapping

```typescript
// Figma drop shadow → Tailwind shadow
Light shadow → shadow-sm or shadow
Medium shadow → shadow-md
Heavy shadow → shadow-lg or shadow-xl

// Figma blur → Tailwind backdrop-blur
10px blur → backdrop-blur-sm
20px blur → backdrop-blur-md
40px blur → backdrop-blur-2xl
```

### Border Radius Mapping

```typescript
// Figma corner radius → Tailwind rounded
4px → rounded
8px → rounded-lg
12px → rounded-xl
16px → rounded-2xl
999px → rounded-full
```

### Animation & Transition Rules

```tsx
// Add to interactive elements
<button className="transition-all duration-300 hover:scale-105">

// Add to cards
<div className="transition-all duration-300 hover:shadow-lg">

// Add to text
<span className="transition-colors duration-200 hover:text-accent">
```

### Responsive Breakpoint Strategy

```tsx
// Mobile-first approach
<div className="flex flex-col lg:flex-row">
  {/* Stacked on mobile, row on desktop */}
</div>

<h1 className="text-4xl sm:text-5xl md:text-6xl">
  {/* Scales up on larger screens */}
</h1>

<section className="py-12 sm:py-20">
  {/* More padding on desktop */}
</section>
```

## 9. Common Figma Patterns & Implementation

### Hero Section Pattern

**Figma Structure:**
- Large heading with animated underlines
- Subheading text
- CTA buttons (primary + secondary)
- Background gradient blur
- Device mockup or illustration

**Implementation:**
```tsx
<section className="section-spacing-lg relative overflow-hidden">
  {/* Background gradient blur */}
  <div className="absolute inset-0 -z-10 overflow-hidden">
    <div className="absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-accent/5 blur-3xl rounded-full"></div>
  </div>

  <div className="container-primary flex flex-col gap-8 items-center justify-center text-center max-w-4xl">
    <h1 className="font-extrabold text-4xl sm:text-5xl md:text-6xl lg:text-7xl tracking-tight leading-[1.1]">
      {/* Heading with animated underline */}
    </h1>

    <p className="text-lg md:text-xl text-base-content/70 leading-relaxed max-w-2xl">
      {/* Subheading */}
    </p>

    <div className="flex flex-col sm:flex-row gap-4">
      {/* CTA buttons */}
    </div>
  </div>
</section>
```

### Card Grid Pattern

**Figma Structure:**
- Grid of cards (2-3 columns)
- Icon at top
- Heading
- Description text
- Hover state

**Implementation:**
```tsx
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  {items.map((item) => (
    <div key={item.id} className="card-modern p-6 hover:scale-105 transition-transform">
      <BetterIcon>
        <svg className="w-6 h-6">{/* icon */}</svg>
      </BetterIcon>

      <h3 className="font-semibold text-lg mt-4 mb-2">
        {item.title}
      </h3>

      <p className="text-base-content/70 text-sm">
        {item.description}
      </p>
    </div>
  ))}
</div>
```

### Pricing Card Pattern

**Figma Structure:**
- Card with optional "Popular" badge
- Plan name
- Price with currency
- Feature list with checkmarks
- CTA button

**Implementation:**
```tsx
<div className="relative w-full max-w-lg">
  {/* Optional badge */}
  {plan.isFeatured && (
    <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 z-20">
      <span className="badge text-xs text-white font-semibold border-0 bg-accent px-3 py-2">
        POPULAR
      </span>
    </div>
  )}

  <div className="relative flex flex-col h-full gap-5 bg-background p-6 md:p-8 rounded-xl border border-border-subtle shadow-lg">
    <p className="text-lg lg:text-xl font-bold">
      {plan.name}
    </p>

    <div className="flex gap-2">
      <p className="text-5xl tracking-tight font-extrabold">${plan.price}</p>
    </div>

    <ul className="space-y-3 flex-1">
      {plan.features.map((feature) => (
        <li key={feature.name} className="flex items-center gap-3">
          <svg className="w-5 h-5 text-accent shrink-0">{/* checkmark */}</svg>
          <span className="text-base-content/80">{feature.name}</span>
        </li>
      ))}
    </ul>

    <button className="btn btn-primary">Get Started</button>
  </div>
</div>
```

### Problem-Solution Flow Pattern

**Figma Structure:**
- 3-step horizontal flow with arrows
- Numbered cards
- Icons representing each step
- Connecting arrows between cards

**Implementation:**
```tsx
<div className="flex flex-col md:flex-row justify-center items-center md:items-start gap-6 max-w-4xl mx-auto">
  <div className="card-modern p-6 w-full md:w-48 flex flex-col gap-3 items-center justify-center relative">
    {/* Number badge */}
    <div className="absolute -top-3 -left-3 w-8 h-8 rounded-full bg-accent text-white font-bold text-base flex items-center justify-center shadow-lg ring-2 ring-white z-10">
      1
    </div>

    {/* Icon with gradient background */}
    <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-red-100 to-red-50 flex items-center justify-center ring-4 ring-red-100/50">
      <svg className="w-8 h-8 text-red-600">{/* icon */}</svg>
    </div>

    <h3 className="font-semibold text-sm">Step title</h3>
  </div>

  {/* Arrow SVG */}
  <svg className="w-12 fill-accent">{/* arrow path */}</svg>

  {/* Repeat for steps 2 and 3 */}
</div>
```

## 10. Configuration & Business Logic

### Pricing Configuration

```typescript
// File: config.ts
const config = {
  stripe: {
    plans: [
      {
        priceId: "price_manual_monthly",
        name: "Manual Monthly",
        description: "Perfect for those who prefer manual control",
        price: 2,
        category: "manual",  // Important for filtering
        features: [
          { name: "Financial health dashboard" },
          { name: "Manual balance updates" },
          // ...
        ],
      },
      // ... other plans
    ],
  },
};
```

**Figma Integration:**
- Extract plan prices from Figma pricing section
- Update `config.ts` to match Figma design
- Ensure `category` field matches toggle state ("manual" or "plaid")

### Brand Configuration

```typescript
const config = {
  appName: "OneView",
  appDescription: "See your complete financial picture in one place...",
  domainName: "one-view.app",
  colors: {
    theme: "light",
    main: "#6e56cf",  // Browser theme color
  },
  auth: {
    loginUrl: "/signin",
    callbackUrl: "/dashboard",
  },
};
```

## 11. Best Practices for Figma MCP Integration

### Do's ✅

1. **Always extract file key and node ID from Figma URLs**
   ```
   https://figma.com/design/ABC123/File-Name?node-id=1-2
   fileKey: ABC123
   nodeId: 1:2 (not 1-2)
   ```

2. **Use design tokens instead of hardcoded values**
   ```tsx
   // ✅ Good
   <div className="bg-accent text-white">

   // ❌ Bad
   <div style={{ backgroundColor: '#6e56cf', color: '#ffffff' }}>
   ```

3. **Follow component patterns established in codebase**
   ```tsx
   // ✅ Good - matches existing pattern
   <section className="section-spacing">
     <div className="container-primary">

   // ❌ Bad - custom styling
   <section style={{ padding: '80px 0' }}>
     <div style={{ maxWidth: '1152px', margin: '0 auto' }}>
   ```

4. **Apply responsive breakpoints**
   ```tsx
   // ✅ Good
   <h1 className="text-4xl sm:text-5xl md:text-6xl">

   // ❌ Bad - no responsive sizing
   <h1 className="text-6xl">
   ```

5. **Use Next.js Image component for images**
   ```tsx
   // ✅ Good
   <Image src="/logo.svg" alt="Logo" width={120} height={28} />

   // ❌ Bad
   <img src="/logo.svg" alt="Logo" />
   ```

### Don'ts ❌

1. **Don't create `tailwind.config.js`**
   - All config goes in `app/globals.css` with `@theme`

2. **Don't use inline styles unless absolutely necessary**
   - Prefer Tailwind utility classes

3. **Don't forget "use client" directive for interactive components**
   ```tsx
   // ❌ Bad - will error with onClick
   const Button = () => <button onClick={...}>

   // ✅ Good
   "use client";
   const Button = () => <button onClick={...}>
   ```

4. **Don't skip awaiting Next.js 15 async APIs**
   ```tsx
   // ❌ Bad - will error
   const cookieStore = cookies();

   // ✅ Good
   const cookieStore = await cookies();
   ```

5. **Don't create new color tokens without justification**
   - Use existing `--color-accent`, `--color-primary`, etc.

### Figma Screenshot Workflow

```typescript
// 1. Get screenshot
await mcp__figma-remote-mcp__get_screenshot({
  fileKey: "ABC123",
  nodeId: "1:2",
});

// 2. Get design context
await mcp__figma-remote-mcp__get_design_context({
  fileKey: "ABC123",
  nodeId: "1:2",
});

// 3. Get variable definitions (colors, spacing, etc.)
await mcp__figma-remote-mcp__get_variable_defs({
  fileKey: "ABC123",
  nodeId: "1:2",
});

// 4. Implement component using design system rules
```

### Code Quality Checklist

- [ ] Component uses TypeScript with proper types
- [ ] Follows Next.js 15 async API patterns (await cookies/headers/params)
- [ ] Uses design tokens from `@theme` in `globals.css`
- [ ] Applies responsive breakpoints (`sm:`, `md:`, `lg:`)
- [ ] Uses Tailwind utility classes (not inline styles)
- [ ] Includes "use client" directive if interactive
- [ ] Uses Next.js `<Image>` component for images
- [ ] Follows established naming conventions (PascalCase for components)
- [ ] Includes proper accessibility attributes (alt text, ARIA labels)
- [ ] Optimized for performance (lazy loading, code splitting)

---

**Last Updated:** 2025-11-07
**Version:** 1.0
**Maintained by:** Claude Code with Figma MCP Integration
